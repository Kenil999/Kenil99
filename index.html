<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AI Prompt Enhancer â€“ Free & Working</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body { font-family: Arial; padding: 20px; background: #fafafa; }
.box { background: white; padding: 15px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px; }
textarea { width: 100%; height: 140px; border: none; resize: none; outline: none; font-size: 16px; }
button { width: 100%; padding: 15px; background: black; color: white; border: none; border-radius: 10px; cursor: pointer; font-size: 18px; }
.hidden { display: none; }
</style>

</head>
<body>

<h2>AI Prompt Enhancer</h2>

<div class="box">
<textarea id="rawPrompt" placeholder="Type your raw prompt..."></textarea>
</div>

<button onclick="generateQuestions()">Refine Prompt</button>

<div id="questionsBox" class="box hidden"></div>
<div id="finalBox" class="box hidden"></div>

<script>
const ENGINEER_PROMPT = `
ROLE
You are an Expert Prompt Engineer...
(keep your full system prompt here)
`;

const HORDE_API_KEY = "0000000000"; // anonymous free key

async function hordeGenerate(promptText) {
    // Step 1: Submit job
    const submit = await fetch("https://aihorde.net/api/v2/generate/text/async", {
        method: "POST",
        headers: {
            "Content-Type": "application/json",
            "apikey": HORDE_API_KEY
        },
        body: JSON.stringify({
            prompt: promptText,
            params: { max_length: 350 }
        })
    });

    const job = await submit.json();
    const id = job.id;

    // Step 2: Poll for completion
    while (true) {
        const poll = await fetch(`https://aihorde.net/api/v2/generate/text/status/${id}`);
        const result = await poll.json();

        if (result.done === true) {
            return result.generations[0].text;
        }

        await new Promise(r => setTimeout(r, 1500));
    }
}

async function generateQuestions() {
    const raw = document.getElementById("rawPrompt").value.trim();
    if (!raw) return;

    document.getElementById("questionsBox").classList.remove("hidden");
    document.getElementById("questionsBox").innerHTML = "Thinking...";

    const prompt = `${ENGINEER_PROMPT}

USER RAW PROMPT:
${raw}

Generate exactly 3 short, clear clarification questions.`;

    const questions = await hordeGenerate(prompt);

    document.getElementById("questionsBox").innerHTML =
        `<strong>Clarification Questions:</strong><br><br>${questions.replace(/\n/g,'<br>')}`;

    generateFinal(raw, questions);
}

async function generateFinal(raw, questions) {
    document.getElementById("finalBox").classList.remove("hidden");
    document.getElementById("finalBox").innerHTML = "Optimizing...";

    const finalPrompt = `${ENGINEER_PROMPT}

USER RAW PROMPT:
${raw}

CLARIFICATION QUESTIONS GENERATED:
${questions}

Now produce the final optimized structured prompt:
- AI Role
- Core Task
- Constraints
- Reasoning Instructions
- Output Format
- Key Improvements`;

    const result = await hordeGenerate(finalPrompt);

    document.getElementById("finalBox").innerHTML =
        `<strong>Optimized Prompt:</strong><br><br>${result.replace(/\n/g,'<br>')}`;
}
</script>

</body>
</html>
